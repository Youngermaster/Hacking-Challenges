var irc = require("irc");

var server = "irc.root-me.org";
var chan = "#root-me_Challenge";
var bot = "Candy";

function decode(base64String) {
  let buff = Buffer(base64String, "base64");
  let result = buff.toString("ascii");

  return result;
}

var client = new irc.Client(server, "Lovecraft", {
  debug: true,
  channels: [chan],
});

// Bot Candy
client.addListener("registered", function (message) {
  console.log("registered", message);
  client.say(bot, "!ep2");
});

client.addListener("message" + chan, function (from, to, message) {
  console.log(from + " => " + to + ": " + message);
});

client.addListener("pm", function (from, message) {
  console.log(from + " => ME: " + message);
  if (from === bot) {
    client.say(bot, "!ep2 -rep " + decode(message));
  }
});
