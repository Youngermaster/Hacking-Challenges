var irc = require("irc");

var server = "irc.root-me.org";
var chan = "#Root-Me_Challenge";
var bot = "Candy";

function get_result(a, b) {
  return (Math.sqrt(a) * b).toFixed(2);
}

var client = new irc.Client(server, "Lovecraft", {
  debug: true,
  channels: [chan],
});

// Bot Candy
client.addListener("registered", function (message) {
  console.log("registered", message);
  client.say(bot, "!ep1");
});

client.addListener("message" + chan, function (from, to, message) {
  console.log(from + " => " + to + ": " + message);
});

client.addListener("pm", function (from, message) {
  console.log(from + " => ME: " + message);
  if (from === bot) {
    let nbs = message.split("/");
    let nb1 = parseInt(nbs[0], 10);
    let nb2 = parseInt(nbs[1], 10);

    let result = get_result(nb1, nb2);
    console.log("Result", result);

    client.say(bot, "!ep1 -rep " + result);
  }
});
